(window.webpackJsonp=window.webpackJsonp||[]).push([[8],{100:function(e,t,n){"use strict";n.d(t,"a",(function(){return p})),n.d(t,"b",(function(){return u}));var a=n(0),r=n.n(a);function l(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function o(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function i(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?o(Object(n),!0).forEach((function(t){l(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):o(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function c(e,t){if(null==e)return{};var n,a,r=function(e,t){if(null==e)return{};var n,a,r={},l=Object.keys(e);for(a=0;a<l.length;a++)n=l[a],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);for(a=0;a<l.length;a++)n=l[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}var s=r.a.createContext({}),b=function(e){var t=r.a.useContext(s),n=t;return e&&(n="function"==typeof e?e(t):i(i({},t),e)),n},p=function(e){var t=b(e.components);return r.a.createElement(s.Provider,{value:t},e.children)},m={inlineCode:"code",wrapper:function(e){var t=e.children;return r.a.createElement(r.a.Fragment,{},t)}},d=r.a.forwardRef((function(e,t){var n=e.components,a=e.mdxType,l=e.originalType,o=e.parentName,s=c(e,["components","mdxType","originalType","parentName"]),p=b(n),d=a,u=p["".concat(o,".").concat(d)]||p[d]||m[d]||l;return n?r.a.createElement(u,i(i({ref:t},s),{},{components:n})):r.a.createElement(u,i({ref:t},s))}));function u(e,t){var n=arguments,a=t&&t.mdxType;if("string"==typeof e||a){var l=n.length,o=new Array(l);o[0]=d;var i={};for(var c in t)hasOwnProperty.call(t,c)&&(i[c]=t[c]);i.originalType=e,i.mdxType="string"==typeof e?e:a,o[1]=i;for(var s=2;s<l;s++)o[s]=n[s];return r.a.createElement.apply(null,o)}return r.a.createElement.apply(null,n)}d.displayName="MDXCreateElement"},60:function(e,t,n){"use strict";n.r(t),n.d(t,"frontMatter",(function(){return l})),n.d(t,"metadata",(function(){return o})),n.d(t,"rightToc",(function(){return i})),n.d(t,"default",(function(){return s}));var a=n(2),r=(n(0),n(100));const l={id:"platform-events",title:"Platform Events",sidebar_label:"Platform Events"},o={unversionedId:"platform-events",id:"platform-events",isDocsHomePage:!1,title:"Platform Events",description:"Platform events are the preferred method for sending messages to initiate realtime transactions.",source:"@site/docs/platform-events.md",permalink:"/docs/platform-events",editUrl:"https://github.com/PropelPLM/developer-docs/edit/master/website/docs/platform-events.md",sidebar_label:"Platform Events",sidebar:"someSidebar",previous:{title:"Introduction to Event-based Messaging and Realtime Integrations",permalink:"/docs/event-based-messaging"},next:{title:"Outbound Messages",permalink:"/docs/outbound-messages"}},i=[{value:"Available Propel Platform Events",id:"available-propel-platform-events",children:[]},{value:"Creating Custom Platform Events",id:"creating-custom-platform-events",children:[]},{value:"Subscribing to a Platform Event Example",id:"subscribing-to-a-platform-event-example",children:[{value:"1. Using the JSForce library, authenticate with Propel",id:"1-using-the-jsforce-library-authenticate-with-propel",children:[]},{value:"2. Subscribe to a Platform Event",id:"2-subscribe-to-a-platform-event",children:[]},{value:"3. Trigger your Platform Event",id:"3-trigger-your-platform-event",children:[]}]},{value:"Additional Resources",id:"additional-resources",children:[]}],c={rightToc:i};function s({components:e,...t}){return Object(r.b)("wrapper",Object(a.a)({},c,t,{components:e,mdxType:"MDXLayout"}),Object(r.b)("p",null,"Platform events are the preferred method for sending messages to initiate realtime transactions. "),Object(r.b)("h2",{id:"available-propel-platform-events"},"Available Propel Platform Events"),Object(r.b)("table",null,Object(r.b)("thead",{parentName:"table"},Object(r.b)("tr",{parentName:"thead"},Object(r.b)("th",Object(a.a)({parentName:"tr"},{align:null}),"Platform Event Name"),Object(r.b)("th",Object(a.a)({parentName:"tr"},{align:null}),"When the event fires"),Object(r.b)("th",Object(a.a)({parentName:"tr"},{align:null}),"Object"))),Object(r.b)("tbody",{parentName:"table"},Object(r.b)("tr",{parentName:"tbody"},Object(r.b)("td",Object(a.a)({parentName:"tr"},{align:null}),"Item Change"),Object(r.b)("td",Object(a.a)({parentName:"tr"},{align:null}),"When a new item is created, and Is Create flag = true"),Object(r.b)("td",Object(a.a)({parentName:"tr"},{align:null}),"Item")),Object(r.b)("tr",{parentName:"tbody"},Object(r.b)("td",Object(a.a)({parentName:"tr"},{align:null}),"Publish Item Revision"),Object(r.b)("td",Object(a.a)({parentName:"tr"},{align:null}),"When an item revision is released"),Object(r.b)("td",Object(a.a)({parentName:"tr"},{align:null}),"Item")),Object(r.b)("tr",{parentName:"tbody"},Object(r.b)("td",Object(a.a)({parentName:"tr"},{align:null}),"Supersede Item Revision"),Object(r.b)("td",Object(a.a)({parentName:"tr"},{align:null}),"When an item revision has been superseded by the release of a new latest released revision"),Object(r.b)("td",Object(a.a)({parentName:"tr"},{align:null}),"Item")),Object(r.b)("tr",{parentName:"tbody"},Object(r.b)("td",Object(a.a)({parentName:"tr"},{align:null}),"Change Event"),Object(r.b)("td",Object(a.a)({parentName:"tr"},{align:null}),"When a change is approved, the event's Is Approved flag = true"),Object(r.b)("td",Object(a.a)({parentName:"tr"},{align:null}),"Change")),Object(r.b)("tr",{parentName:"tbody"},Object(r.b)("td",Object(a.a)({parentName:"tr"},{align:null}),"Change Event"),Object(r.b)("td",Object(a.a)({parentName:"tr"},{align:null}),"When a change is cancelled, the event's Is Cancelled flag = true"),Object(r.b)("td",Object(a.a)({parentName:"tr"},{align:null}),"Change")),Object(r.b)("tr",{parentName:"tbody"},Object(r.b)("td",Object(a.a)({parentName:"tr"},{align:null}),"Change Event"),Object(r.b)("td",Object(a.a)({parentName:"tr"},{align:null}),"When the change's phase is updated, the event's Is Update flag = true"),Object(r.b)("td",Object(a.a)({parentName:"tr"},{align:null}),"Change")),Object(r.b)("tr",{parentName:"tbody"},Object(r.b)("td",Object(a.a)({parentName:"tr"},{align:null}),"Quality Event"),Object(r.b)("td",Object(a.a)({parentName:"tr"},{align:null}),"When a quality is approved, the event's Is Approved flag = true"),Object(r.b)("td",Object(a.a)({parentName:"tr"},{align:null}),"Quality")),Object(r.b)("tr",{parentName:"tbody"},Object(r.b)("td",Object(a.a)({parentName:"tr"},{align:null}),"Quality Event"),Object(r.b)("td",Object(a.a)({parentName:"tr"},{align:null}),"When a quality's phase is updated, the event's Is Update flag = true"),Object(r.b)("td",Object(a.a)({parentName:"tr"},{align:null}),"Quality")))),Object(r.b)("h2",{id:"creating-custom-platform-events"},"Creating Custom Platform Events"),Object(r.b)("p",null,"To create your own custom platform events, see the ",Object(r.b)("a",Object(a.a)({parentName:"p"},{href:"https://developer.salesforce.com/docs/atlas.en-us.platform_events.meta/platform_events/platform_events_intro.htm"}),"Platform Events Developer Guide"),"."),Object(r.b)("h2",{id:"subscribing-to-a-platform-event-example"},"Subscribing to a Platform Event Example"),Object(r.b)("p",null,"Subscribing to a Platform Event and receiving messages is a straightforward process involving very little code."),Object(r.b)("p",null,"To begin, identify the Platform Event you'd like to subscribe to. In this example, we'll be subscribing to a Platform Event event that exists in the Propel Managed Package called ",Object(r.b)("inlineCode",{parentName:"p"},"PDLM__Change_Event__e"),". You can see the sample code ",Object(r.b)("a",Object(a.a)({parentName:"p"},{href:"https://github.com/propelplm/examples/platform-event-sample"}),"here"),"."),Object(r.b)("h3",{id:"1-using-the-jsforce-library-authenticate-with-propel"},"1. Using the JSForce library, authenticate with Propel"),Object(r.b)("p",null,"In the sample code, remember to modify your username and password in the ",Object(r.b)("inlineCode",{parentName:"p"},"config.editme.js")," file and remove the ",Object(r.b)("inlineCode",{parentName:"p"},"editme")," string from the filename."),Object(r.b)("pre",null,Object(r.b)("code",Object(a.a)({parentName:"pre"},{className:"language-javascript",metastring:'title="index.js"',title:'"index.js"'}),"var conn = new jsforce.Connection({\n  // you can change loginUrl to connect to sandbox or prerelease env.\n  // loginUrl : 'https://test.salesforce.com'\n});\nconn.login(config.username, config.password, function(err, userInfo) {\n  if (err) { return console.error(err); }\n\n  console.log(\"Authenticated and waiting for a message...\");\n\n  // ...\n});\n")),Object(r.b)("h3",{id:"2-subscribe-to-a-platform-event"},"2. Subscribe to a Platform Event"),Object(r.b)("p",null,"Now that you're authenticated, add a few lines of code to subscribe to the Platform Event. Make sure that you use the API Name of the event. For example the ",Object(r.b)("inlineCode",{parentName:"p"},"Change Event")," in the table above would translate to ",Object(r.b)("inlineCode",{parentName:"p"},"PDLM__Change_Event__e"),". You can find the API names of Platform Events in ",Object(r.b)("strong",{parentName:"p"},"Salesforce Setup > Integrations > Platform Events"),"."),Object(r.b)("pre",null,Object(r.b)("code",Object(a.a)({parentName:"pre"},{className:"language-javascript",metastring:'title="index.js" {10-12}',title:'"index.js"',"{10-12}":!0}),'var conn = new jsforce.Connection({\n  // you can change loginUrl to connect to sandbox or prerelease env.\n  // loginUrl : \'https://test.salesforce.com\'\n});\nconn.login(config.username, config.password, function(err, userInfo) {\n  if (err) { return console.error(err); }\n\n  console.log("Authenticated and waiting for a message...");\n\n  conn.streaming.topic("/event/PDLM__Change_Event__e").subscribe(function(message) {\n    console.dir(message);\n  });\n\n  // ...\n});\n')),Object(r.b)("h3",{id:"3-trigger-your-platform-event"},"3. Trigger your Platform Event"),Object(r.b)("p",null,"Now that your code is written, run the local server by entering ",Object(r.b)("inlineCode",{parentName:"p"},"node index.js")," in terminal."),Object(r.b)("p",null,"After you've started the server, open your Propel org and complete the action in the interface that will trigger the Platform Event. In this example, we will release a change order in Propel to trigger the ",Object(r.b)("inlineCode",{parentName:"p"},"Change_Event")," Platform Event."),Object(r.b)("p",null,"The results will display in the console with a response similar to the following:"),Object(r.b)("pre",null,Object(r.b)("code",Object(a.a)({parentName:"pre"},{className:"language-javascript",metastring:'title="Console"',title:'"Console"'}),"{ schema: 'TlstWsBmf0CW6PhV2bBHqQ',\n  payload: \n   { \n      PDLM__Is_Approved__c: 'True',\n      PDLM__Is_Cancelled__c: false,\n      PDLM__Is_Descriptive__c: false,\n      PDLM__Is_Update__c: false,\n      PDLM__Record_Id__c: '0063a00000Ae8xEEDC',\n      PDLM__Session__c: 'omitted',\n      PDLM__Value__c: '',\n      CreatedById: '0053j00000Ae8xDAAR',\n      CreatedDate: '2020-08-14T00:32:41Z' },\n  event: { replayId: 36104 } }\n")),Object(r.b)("h2",{id:"additional-resources"},"Additional Resources"),Object(r.b)("p",null,Object(r.b)("a",Object(a.a)({parentName:"p"},{href:"https://trailhead.salesforce.com/en/content/learn/modules/platform_events_basics/platform_events_architecture"}),"Event-driven Architecture Trailhead")))}s.isMDXComponent=!0}}]);